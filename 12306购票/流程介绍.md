


          
### 12306购票项目 - 最新操作流程介绍

#### 一、程序启动与模式选择

##### 1. 正常购票模式
```bash
cd 12306购票
python main.py
```

##### 2. 测试模式（不提交真实订单）
```bash
cd 12306购票
python main.py --test
```
> 测试模式会模拟完整购票流程，但不会提交真实订单，适合功能验证

#### 二、完整操作流程

##### 1. 账号登录阶段
```
请输入12306账号：[您的12306账号]
请输入12306密码：[您的12306密码]
```
> 系统会自动下载验证码图片并尝试打开，图片保存路径会显示在控制台
> 如无法自动打开图片，请手动访问提示路径（通常为项目根目录下的captcha.jpg）

```
验证码图片已保存至: c:\Users\26937\Desktop\12306购票项目\12306购票\captcha.jpg
请输入验证码坐标（例如：35,45,100,100）
```
> 坐标输入格式：x1,y1,x2,y2（按验证码图片上的提示顺序点击）

##### 2. 行程信息输入阶段（带验证机制）
```
请输入出发站：北京西
请输入到达站：上海虹桥
请输入乘车日期(YYYY-MM-DD)：2023-10-01
请输入坐席类型(一等座/二等座/硬座/硬卧)：二等座
```
> 系统会验证：
> - 日期格式是否正确（必须为YYYY-MM-DD）
> - 日期是否为当前日期或之后
> - 车站名称是否存在于12306车站列表中
> 验证失败会提示错误并要求重新输入

##### 3. 车次查询与选择
系统会自动查询符合条件的车次，默认选择第一个可用车次
> 提示：当前版本自动选择第一个车次，高级版本可手动选择

##### 4. 乘客选择阶段
```
获取乘客信息有：
[0] 张三 (身份证:110********1234)
[1] 李四 (身份证:310********5678)
输入要购票的乘车人的下标：0
```
> 输入乘客对应的数字下标进行选择

##### 5. 订单处理阶段

###### 5.1 测试模式下
```
===== 测试模式 =====
模拟提交订单: [车次信息]
模拟购票乘客: 张三
订单令牌: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
===== 测试模式结束 =====
```
> 测试模式到此结束，不会提交真实订单

###### 5.2 正常模式下
```
订单初始化成功
订单提交成功
订单状态：排队中...
订单状态：处理中...
购票成功！
```
> 系统会每2秒查询一次订单状态，最多查询30次（约60秒）
> 若超时未成功会提示"查询订单状态超时"

#### 三、异常处理与提示

1. **登录相关**
   - 验证码错误：会提示"验证码验证失败"并重新获取验证码
   - 账号密码错误：会提示"登录失败: [具体原因]"

2. **输入相关**
   - 日期无效："日期格式错误或已过期，请重新输入"
   - 车站不存在："出发站或到达站不存在，请重新输入"

3. **网络相关**
   - 网络请求错误："网络请求错误: [具体错误信息]"
   - 接口超时：会自动重试关键请求

4. **订单相关**
   - 订单提交失败："订单提交失败：[具体原因]"
   - 无可用车次："未查询到可用车次或车站信息错误"并提供重试选项

#### 四、程序退出与资源清理
无论购票成功、失败或中途退出，程序都会：
1. 自动执行账号登出操作
2. 清理临时验证码图片文件
3. 关闭网络会话释放资源
4. 显示"程序已正常结束"提示

#### 五、流程图
```
启动程序 → 选择模式 → 输入账号密码 → 处理验证码 → 输入行程信息 →
验证信息 → 查询车次 → 选择乘客 → 初始化订单 → [测试模式/正常模式] →
自动登出 → 清理资源 → 程序结束
```
        